webpackJsonp([4],{1212:function(e,t,n){"use strict";function r(e){var t=e.text,n=e.translate;return i.a.createElement(c,null,n?i.a.createElement(l.a,{id:t}):t)}var a=n(0),i=n.n(a),u=n(29),l=n(55),o=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  color: ",";\n  margin-bottom: ",";\n"],["\n  color: ",";\n  margin-bottom: ",";\n"]),c=u.c.h1(o,function(e){return e.theme.color.primary},function(e){return e.theme.spaces.main});t.a=r},1253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"getTechnicalTeamSurvey",function(){return b}),n.d(t,"getFailedRequest",function(){return p}),n.d(t,"filterTechnicalTeamSurvey",function(){return d}),n.d(t,"setScore",function(){return S}),n.d(t,"setComment",function(){return g}),n.d(t,"finishTechnicalTeamSurvey",function(){return T});var r=n(404),a=n(394),i=n(1254),u=n(395),l=n(208),o=n(211),c=function(){return{type:r.e}},s=function(e){return{type:r.f,data:e}},p=function(){return{type:r.g}},d=function(e){return{type:r.d,data:e}},f=function(){return{type:r.a}},m=function(e,t,n,a){return{type:r.c,idSupplier:e,answer:n,value:a,new:!t}},v=function(e,t,n,a){return{type:r.b,idSupplier:e,comment:n,value:a,new:!t}},y=function(e){return{type:r.h,data:e}},h=function(e,t){return{type:r.i,idSuppliers:e,idSuppliersByCall:t}},S=function(e,t,n){return function(r){Object(l.a)(r,c,i.a,n).then(function(a){r(m(e,n.id,a.data.data,t)),r(f())}).catch(function(){r(m(e,n.id,n,null)),r(p())})}},g=function(e,t,n){return function(r,a){a().technicalTeamSurvey.data.suppliers.find(function(t){return t.id===e}).comments.find(function(e){return e.idService===n.idService}).value!==t&&Object(l.a)(r,c,i.b,n).then(function(a){r(v(e,n.id,a.data.data,t))}).catch(function(){r(v(e,n.id,n,null)),r(p())})}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(n){Object(l.a)(n,c,a.k,e).then(function(e){var r=e.data.data;r.suppliers=r.suppliers.map(function(e){var t=r.suppliersByCall.find(function(t){return t.idSupplier===e.id}),n=t.id,a=t.idState,i=r.masters.Item.map(function(e){var t=r.masters.TechnicalTeamAnswer.find(function(t){return t.idItem===e.id&&t.idSupplierByCall===n}),a=t?r.masters.EvaluationScale.find(function(e){return e.id===t.idEvaluationScale}):null;return{id:e.id,idService:e.idService,defaultValue:{key:a?a.id:null,name:a?a.name:null},value:a?a.score:null,error:!1}}),u=[],l=[];r.masters.Service.forEach(function(e){var t=r.masters.TechnicalTeamComment.find(function(t){return t.idSupplierByCall===n&&t.idService===e.id});u.push({idService:e.id,value:t?t.comment:""}),l.push({idService:e.id,value:null})});var o=r.masters.State.find(function(e){return e.id===a}).shortName,c="NOT_STARTED_TECHNICAL_TEAM"!==o&&"TECHNICAL_TEAM"!==o||""!==t.whoEvaluateOfTechnicalTeam&&t.whoEvaluateOfTechnicalTeam!==r.masters.User[0].name,s=!c&&t.whoEvaluateOfTechnicalTeam===r.masters.User[0].name;return e.visible=!0,e.readOnly=c,e.required=s,e.items=i,e.comments=u,e.totals=l,e.total=null,e}),r.masters.Service.push({id:"total",name:"Resumen total"}),r.masters.Service.forEach(function(e,t){"total"!==e.id&&(r.masters.Item=r.masters.Item.concat([{idService:e.id,id:"comment"+t.toString(),type:"comment",name:"Comentarios"},{idService:e.id,id:"subtotal"+t.toString(),idServiceForTotal:e.id,type:"subtotal",name:"Total"}])),r.masters.Item.push({idService:"total",id:"total"+t.toString(),idServiceForTotal:e.id,type:t<r.masters.Service.length-1?"subtotal":"total",name:t<r.masters.Service.length-1?e.name:"Total general"})}),r.masters.EvaluationScale=Object(l.c)(r.masters.EvaluationScale,"score"),r.supplierId=t,n(s(r)),n(f())}).catch(function(){n(p())})}},T=function(){return function(e,t){var n=t().technicalTeamSurvey.data,r=n.suppliers,a=n.suppliersByCall,i=[],s=[],d=r.map(function(e){var t=Object.assign({},e,{items:e.items.map(function(t){return Object.assign({},t,{error:e.visible&&e.required&&!t.value})})});return e.visible&&!e.readOnly&&e.items.filter(function(e){return e.value}).length===e.items.length&&(i.push(a.find(function(t){return t.idSupplier===e.id}).id),s.push(e.id)),t});r.filter(function(e){return e.required}).length===i.length?Object(l.a)(e,c,u.e,{idSuppliersByCall:i}).then(function(){e(y(d)),e(h(s,i))}).catch(function(){e(p())}):(e(y(d)),Object(o.a)("Algunos proveedores no han sido calificados completamente","error"))}}},1254:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(82),a=function(e){return r.a.post("TechnicalTeamAnswer?action=save",e)},i=function(e){return r.a.post("TechnicalTeamComment?action=save",e)}},1395:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=n(0),l=n.n(u),o=n(129),c=n(22),s=n(101),p=n(1253),d=n(1396),f=n(392),m=n(1397),v=n(1212),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(e){function t(){var e,n,i,u;r(this,t);for(var l=arguments.length,o=Array(l),c=0;c<l;c++)o[c]=arguments[c];return n=i=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),i.getDataSupplier=function(){var e=i.props.location.pathname,t=e.split("/");return t.length>2?t[2]:""},i.filterSupplier=function(e){var t={supplier:e};i.props.filterTechnicalTeamSurvey(t)},u=n,a(i,u)}return i(t,e),y(t,[{key:"componentDidMount",value:function(){var e=this.getDataSupplier();this.props.getTechnicalTeamSurvey("",e),""!==e&&this.filterSupplier(e)}},{key:"componentWillReceiveProps",value:function(e){e.data.supplierId!==this.props.data.supplierId&&this.filterSupplier(e.data.supplierId)}},{key:"render",value:function(){return l.a.createElement(c.u,{spinning:this.props.loading},l.a.createElement(v.a,{text:"Calificaci\xf3n comit\xe9 t\xe9cnico"}),l.a.createElement(f.a,Object.assign({},this.props,{formData:d.a})),l.a.createElement(m.a,this.props))}}]),t}(u.Component),S=function(e){return{data:e.technicalTeamSurvey.data,loading:e.technicalTeamSurvey.loading}};t.a=Object(s.e)(Object(o.b)(S,p)(h))},1396:function(e,t,n){"use strict";var r=function(e){var t=e.data,n=e.getTechnicalTeamSurvey,r=e.filterTechnicalTeamSurvey,a=e.form,i=t.years,u=t.suppliers,l=t.masters,o=t.supplierId,c=function(){a.resetFields(),n()};return[{key:1.1,value:[{span:8,type:"select",label:"A\xf1o",key:"year",value:i&&i.length>0?i[0]:"",options:i?i.map(function(e){return{id:e,name:e}}):[],handleChange:n,allowClear:!1,valuesToClean:{supply:{value:""},category:{value:""},country:{value:""},supplier:{value:""}}},{span:8,type:"select",label:"Tipo de suministro",key:"supply",value:"",options:l?l.Supply:[],handleChange:function(e){var t=Object.assign({},a.getFieldsValue(),{supply:e});r(t)}},{span:8,type:"select",label:"Categor\xeda",key:"category",value:"",options:l?l.Category:[],handleChange:function(e){var t=Object.assign({},a.getFieldsValue(),{category:e});r(t)}}]},{key:1.2,value:[{span:8,type:"select",label:"Pa\xeds",key:"country",value:"",options:l?l.Country:[],handleChange:function(e){var t=Object.assign({},a.getFieldsValue(),{country:e});r(t)}},{span:8,type:"select",label:"Proveedor",key:"supplier",value:o,options:u?u.map(function(e){return e.name=e.businessName,e}):[],handleChange:function(e){var t=Object.assign({},a.getFieldsValue(),{supplier:e});r(t)}},{span:8,type:"select",label:"Tama\xf1o",key:"companySize",value:"",options:l?l.CompanySize:[],handleChange:function(e){var t=Object.assign({},a.getFieldsValue(),{companySize:e});r(t)}}]},{key:1.4,justify:"center",value:[{span:2,type:"button",label:"Limpiar",key:"clear",buttonType:"primary",handleclick:c}]}]};t.a=r},1397:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=n(0),l=n.n(u),o=n(22),c=n(400),s=n(210),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=o.w.Column,f=o.x.TabPane,m=o.t.Option,v=o.i.TextArea,y=function(e){function t(){var e,n,i,u;r(this,t);for(var s=arguments.length,p=Array(s),y=0;y<s;y++)p[y]=arguments[y];return n=i=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(p))),i.getHelp=function(e,t){return e?l.a.createElement(o.y,{placement:"topRight",title:e},l.a.createElement(o.h,{style:{marginLeft:5,marginRight:0,color:t?"#fff":"#37907c"},type:"question-circle"+(t?"-o":"")})):null},i.getServices=function(){return i.props.data.masters.Service.map(function(e){return l.a.createElement(f,{tab:l.a.createElement(c.a,null,e.name,i.getHelp(e.helpText,!0)),key:e.id},i.getSuppliers(e))})},i.getSuppliers=function(e){var t=i.props.data,n=t.suppliers;return l.a.createElement(o.w,{rowKey:function(e){return e.id},dataSource:n.filter(function(e){return e.visible})},i.getSupplierColumns(),i.getItemsColumns(e))},i.getSupplierColumns=function(){var e=i.props.data,t=e.suppliersByCall,n=e.masters;return[{title:"Estado",key:"surveyState",render:function(e,r){var a=t.find(function(e){return e.idSupplier===r.id}).idState;return n.State.find(function(e){return e.id===a}).name}},{title:"Evaluado por",key:"negotiator",render:function(e,n){return t.find(function(e){return e.idSupplier===n.id}).whoEvaluateOfTechnicalTeam}},{title:"Nombre del proveedor",key:"businessName"},{title:"Tipo de suministro",key:"idSupply",render:function(e,t){return n.Supply.find(function(e){return e.id===t.idSupply}).name}},{title:"Categor\xeda",key:"idCategory",render:function(e,t){var r=n.Category.find(function(e){return e.id===t.idCategory});return r?r.name:""}},{title:"Tama\xf1o de empresa",key:"idCompanySize",render:function(e,t){var r=n.CompanySize.find(function(e){return e.id===t.idCompanySize});return r?r.name:""}}].map(function(e){return l.a.createElement(d,{title:e.title,key:e.key,dataIndex:e.key,render:e.render})})},i.getItemsColumns=function(e){return i.props.data.masters.Item.filter(function(t){return t.idService===e.id}).map(function(t){return l.a.createElement(d,{title:l.a.createElement("div",null,t.name,i.getHelp(t.helpText&&t.helpText.split("\r\n").map(function(e){return l.a.createElement("div",null,""+e)}))),key:t.id,dataIndex:t.id,render:function(n,r){switch(t.type){case"comment":return i.getComment(e,r);case"subtotal":return i.getSubTotal(t,r);case"total":return r.total?r.total.toFixed(2):null;default:return i.getScore(t,r)}}})})},i.getComment=function(e,t){var n=t.comments.find(function(t){return t.idService===e.id}).value;return t.readOnly?n:l.a.createElement(v,{rows:4,defaultValue:n,onBlur:function(n){return i.changeComment(t,e,n.target.value)}})},i.getSubTotal=function(e,t){var n=t.totals.find(function(t){return t.idService===e.idServiceForTotal}).value;return n?n.toFixed(2):null},i.getScore=function(e,t){var n=i.props.data,r=n.masters,a=t.items.find(function(t){return t.id===e.id}),u=a.defaultValue;return t.readOnly?u.name:l.a.createElement("div",null,l.a.createElement(o.t,{labelInValue:!0,key:t.id,defaultValue:u,allowClear:!1,style:{width:50},onChange:function(n){i.changeScore(t,e,n)}},r.EvaluationScale.map(function(e){return l.a.createElement(m,{key:e.id,value:e.id},e.name)})),a.error?l.a.createElement(c.b,null,"Campo requerido"):null)},i.changeComment=function(e,t,n){var r=i.props,a=r.data,u=r.setComment,l=a.suppliersByCall,o=a.masters,c=e.id,s=t.id,p=l.find(function(e){return e.idSupplier===c}).id,d=o.TechnicalTeamComment.find(function(e){return e.idSupplierByCall===p&&e.idService===s});d||(d={idSupplierByCall:p,idService:s}),d.comment=n,u(c,n,d)},i.changeScore=function(e,t,n){var r=i.props,a=r.data,u=r.setScore,l=a.suppliersByCall,o=a.masters,c=e.id,s=t.id,p=l.find(function(e){return e.idSupplier===c}).id,d=o.TechnicalTeamAnswer.find(function(e){return e.idSupplierByCall===p&&e.idItem===s});d||(d={idSupplierByCall:p,idService:t.idService,idItem:s}),d.idEvaluationScale=n.key,u(c,n,d)},u=n,a(i,u)}return i(t,e),p(t,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.finishTechnicalTeamSurvey,r=t.suppliers,a=t.masters;return r?l.a.createElement("div",null,"Escala de evaluaci\xf3n",this.getHelp(a.EvaluationScale.map(function(e){return l.a.createElement("div",null,e.name+": "+e.helpText)})),l.a.createElement(c.c,{animated:!1,style:{marginTop:10}},this.getServices()),r.filter(function(e){return e.visible&&e.required}).length>0?l.a.createElement(o.s,{type:"flex",justify:"center"},l.a.createElement(o.e,{span:2},l.a.createElement(s.a,{title:"\xbfConfirma que desea finalizar?",method:function(){return n()}},l.a.createElement(o.b,{type:"primary"},"Finalizar")))):null):null}}]),t}(u.Component);t.a=y},438:function(e,t,n){"use strict";function r(){return i.a.createElement(u.a,null)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n.n(a),u=n(1395);t.default=r}});
//# sourceMappingURL=4.70f05c44.chunk.js.map